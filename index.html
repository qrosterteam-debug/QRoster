<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QRoster Dashboard</title>

  <!-- html5-qrcode -->
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>

  <!-- Your existing CSS (keeps style.css) -->
  <link rel="stylesheet" href="style.css" />

  <style>
    /* small overrides used by the new layout (kept minimal) */
    /* ensure scanner area has a fixed ratio and no overflow */
    .scanner-inner { width: 100%; max-width: 680px; margin: 0 auto; }
    .scanner-canvas-wrap { position: relative; border-radius:8px; overflow:hidden; background:#000; }
    .scanner-overlay {
      position:absolute; inset:0; pointer-events:none;
      display:flex; align-items:center; justify-content:center;
    }
    .scanner-frame {
      width:70%;
      max-width:420px;
      aspect-ratio: 4/3;
      border: 6px solid rgba(255,255,255,0.06);
      box-shadow: inset 0 0 0 2px rgba(255,255,255,0.02);
      display:flex; align-items:center; justify-content:center;
      position:relative;
    }
    .scanner-corners {
      position:absolute; inset:0; pointer-events:none;
      background: linear-gradient(180deg, rgba(0,0,0,0.25), transparent 35%);
    }
    /* camera select + start button style tweaks */
    .camera-controls { display:flex; gap:8px; align-items:center; margin-top:8px; flex-wrap:wrap; }
    .btn { border:none; padding:8px 12px; border-radius:6px; cursor:pointer; background:#3b82f6; color:#fff; }
    .btn.secondary { background:#f1f5f9; color:#0b3b84; border:1px solid #d1d9ec; }
    .btn.ghost { background:transparent; color:#0b3b84; border:1px solid rgba(11,59,132,0.06); }
    .subject-list-scroll { max-height: calc(100vh - 220px); overflow:auto; padding-right:6px; }
    /* ensure small-screen layout for scanner + table stacks nicely */
    @media (max-width: 900px) {
      .scanner-frame { width: 90%; aspect-ratio: 4/3; max-width: none; }
      .scanner-inner { max-width: 100%; }
      .subject-list-scroll { max-height: 28vh; }
    }
  </style>
</head>
<body>
  <!-- topbar -->
  <div class="topbar">
    <div class="left">
      <button id="sidebar-toggle" class="icon-btn">...</button>
      <div class="brand">QRoster</div>
    </div>

    <div class="right">
      <!-- Small right area (date/time) -->
      <div id="top-right-info" style="color:white; font-weight:700;">
        <span id="today-label"></span>
      </div>
    </div>
  </div>

  <div class="layout">
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-inner">
        <div class="sidebar-logo-wrap">
          <!-- Logo image file (replace path with QRosterLogo.png if available) -->
          <img id="sidebar-logo" class="sidebar-logo" src="QRosterLogo.png" alt="QRoster">
        </div>

        <nav class="nav subject-list-scroll" id="nav-subjects">
          <!-- Home -->
          <button class="nav-btn active" data-subject="home" id="nav-home">
            üè† Home
          </button>

          <!-- subjects will be appended here by JS -->
        </nav>

        <div class="sidebar-bottom">
          <div id="user-info">Not signed in</div>
          <div class="login-actions">
            <button id="login" class="primary">Sign in with Google</button>
            <button id="logout" class="btn ghost" style="display:none;">Logout</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main content -->
    <main class="content">
      <!-- HOME -->
      <section id="home" class="tab-content active">
        <div class="home-card">
          <img src="QRosterLogo.png" class="home-logo" alt="QRoster logo" id="home-logo">
          <h1>Welcome to QRoster</h1>
          <p>Choose a subject on the left to start taking the attendance of the students, QRoster makes it easier to take the attendance of the students.</p>
        </div>
      </section>

      <!-- dynamic subject panels will be injected here -->
      <div id="subject-containers"></div>

      <!-- Attendance History (kept separate tab) -->
      <section id="history" class="tab-content">
        <div class="subject-panel">
          <h3>üìú Attendance History</h3>
          <div class="history-controls">
            <select id="history-subject-select"></select>
            <input id="history-date" type="date" />
            <button id="history-refresh" class="btn secondary">Show</button>
            <button id="export-history" class="btn">Export CSV</button>
          </div>

          <div id="history-results"></div>
        </div>
      </section>
    </main>
  </div>

  <!-- Confirm modal -->
  <div id="confirm-modal" class="modal" aria-hidden="true">
    <div class="modal-panel">
      <h4 id="confirm-title">Confirm</h4>
      <p id="confirm-message">Are you sure?</p>
      <div class="modal-actions">
        <button id="confirm-no" class="btn secondary">Cancel</button>
        <button id="confirm-yes" class="btn danger">Yes, finalize</button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" style="display:none;"></div>

  <!-- App script -->
  <script type="module" src="./app.js"></script>
</body>
</html>
