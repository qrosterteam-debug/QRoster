<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QRoster - Complete Attendance System</title>
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header with role buttons -->
    <header class="header">
        <div class="header-content">
            <h1>ðŸ“± QRoster</h1>
            <p>Complete School Attendance System</p>
            <div class="auth-buttons">
                <button class="role-btn active" data-role="teacher">
                    <i class="fas fa-chalkboard-teacher"></i> Teacher
                </button>
                <button class="role-btn" data-role="student">
                    <i class="fas fa-user-graduate"></i> Student
                </button>
                <button class="role-btn" data-role="admin" style="display: none;">
                    <i class="fas fa-crown"></i> Admin
                </button>
            </div>
        </div>
    </header>

    <!-- Sidebar Tabs (ALL NEW TABS) -->
    <nav class="sidebar">
        <div class="tab-buttons">
            <button class="tab-btn active" data-tab="home"><i class="fas fa-home"></i> Home</button>
            <button class="tab-btn" data-tab="attendance"><i class="fas fa-clipboard-list"></i> Attendance</button>
            <button class="tab-btn" data-tab="history"><i class="fas fa-history"></i> History</button>
            <button class="tab-btn" data-tab="qrgen"><i class="fas fa-qrcode"></i> QR Creation</button>
            <button class="tab-btn" data-tab="classes"><i class="fas fa-users"></i> Classes</button>
            <button class="tab-btn" data-tab="subjects"><i class="fas fa-book"></i> Subjects</button>
            <button class="tab-btn" data-tab="myattendance" style="display: none;"><i class="fas fa-chart-bar"></i> My Attendance</button>
            <button class="tab-btn" data-tab="analytics" style="display: none;"><i class="fas fa-chart-pie"></i> Analytics</button>
            <button class="tab-btn" data-tab="admin" style="display: none;"><i class="fas fa-cogs"></i> Admin</button>
        </div>
        <div class="user-info" style="display: none;">
            <div class="user-avatar"></div>
            <div class="user-details">
                <span class="user-name"></span>
                <span class="user-role"></span>
            </div>
            <button class="logout-btn"><i class="fas fa-sign-out-alt"></i></button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Tab -->
        <section id="home" class="tab-content active">
            <div class="auth-container">
                <div class="auth-form">
                    <h2 id="auth-title">Welcome to QRoster</h2>
                    <form id="auth-form">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="email" placeholder="teacher@school.com" required>
                        </div>
                        <div class="password-field">
                            <label>Password</label>
                            <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                            <i class="fas fa-eye eye-icon" data-target="password"></i>
                        </div>
                        <button type="submit" class="btn-primary full-width" id="auth-submit">
                            <span id="auth-text">Sign In</span>
                        </button>
                    </form>
                    <div class="auth-toggle">
                        <span id="toggle-text">Need an account?</span>
                        <button type="button" class="btn-secondary toggle-auth" id="toggle-auth">
                            Register
                        </button>
                    </div>
                </div>
                <div class="tutorial-container" id="tutorial-container" style="display: none;">
                    <h3><i class="fas fa-lightbulb"></i> Quick Start Guide</h3>
                    <div id="tutorial-content"></div>
                </div>
            </div>
        </section>

        <!-- Attendance Tab (NEW class select) -->
        <section id="attendance" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-clipboard-list"></i> Take Attendance</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Class/Section</label>
                        <select id="class-select">
                            <option value="">Select Class...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Subject</label>
                        <select id="subject-select">
                            <option value="">Select Subject...</option>
                        </select>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="btn-primary" id="start-scanner"><i class="fas fa-camera"></i> Start Scanner</button>
                    <button class="btn-success" id="finalize-attendance" disabled>Finalize</button>
                    <button class="btn-secondary" id="export-csv" disabled>Export CSV</button>
                </div>
                <div id="scanner-container"></div>
            </div>
            <div id="attendance-table-container"></div>
        </section>

        <!-- History Tab (NEW date pickers) -->
        <section id="history" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-history"></i> Attendance History</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Start Date</label>
                        <input type="date" id="history-start-date">
                    </div>
                    <div class="form-group">
                        <label>End Date</label>
                        <input type="date" id="history-end-date">
                    </div>
                    <button class="btn-primary" id="filter-history">Filter</button>
                </div>
                <div id="history-list"></div>
            </div>
        </section>

        <!-- QR Creation Tab (NEW) -->
        <section id="qrgen" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-qrcode"></i> Create Student QR Codes</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Student Name</label>
                        <input type="text" id="qr-name" placeholder="John Doe">
                    </div>
                    <div class="form-group">
                        <label>Section/Grade</label>
                        <input type="text" id="qr-section" placeholder="Grade 7-A">
                    </div>
                    <div class="form-group">
                        <label>LRN / Student ID</label>
                        <input type="text" id="qr-lrn" placeholder="1234567890">
                    </div>
                </div>
                <div class="qr-actions">
                    <button class="btn-primary" id="generate-qr"><i class="fas fa-qrcode"></i> Generate QR</button>
                    <button class="btn-success" id="download-qr" disabled><i class="fas fa-download"></i> Download</button>
                    <button class="btn-secondary" id="print-qr" disabled><i class="fas fa-print"></i> Print</button>
                </div>
                <div id="qr-preview" class="qr-preview"></div>
            </div>
        </section>

        <!-- Classes Tab (NEW) -->
        <section id="classes" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-users"></i> Class Management</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>New Class Name</label>
                        <input type="text" id="new-class-name" placeholder="Grade 7-A">
                    </div>
                    <button class="btn-primary" id="create-class">Create Class</button>
                </div>
                <div class="import-section">
                    <h4>Import Students (CSV)</h4>
                    <p>Format: ID,Name,Section,LRN</p>
                    <input type="file" id="csv-import" accept=".csv" class="file-input">
                    <button class="btn-primary" id="import-students">Import Students</button>
                </div>
                <div id="classes-list"></div>
            </div>
        </section>

        <!-- Subjects Tab (NEW) -->
        <section id="subjects" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-book"></i> Subject Management</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>New Subject</label>
                        <input type="text" id="new-subject" placeholder="Mathematics">
                    </div>
                    <button class="btn-primary" id="add-subject">Add Subject</button>
                </div>
                <div id="subjects-list"></div>
            </div>
        </section>

        <!-- My Attendance Tab (NEW - Student Only) -->
        <section id="myattendance" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-chart-bar"></i> My Attendance</h3>
                <div class="form-group">
                    <label>Subject</label>
                    <select id="my-subject-select">
                        <option value="">All Subjects</option>
                    </select>
                </div>
                <div id="my-attendance-list"></div>
            </div>
        </section>

        <!-- Analytics Tab (NEW - Admin/Teacher) -->
        <section id="analytics" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-chart-pie"></i> Analytics Dashboard</h3>
                <div id="analytics-dashboard">
                    <div class="stat-card">
                        <h4>Total Sessions</h4>
                        <span id="total-sessions" class="stat-number">0</span>
                    </div>
                    <div class="stat-card">
                        <h4>Avg Attendance</h4>
                        <span id="avg-attendance" class="stat-number">0%</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Tab (NEW - Admin Only) -->
        <section id="admin" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-cogs"></i> Admin Management</h3>
                <div id="admin-users-list"></div>
            </div>
        </section>
    </main>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="app.js"></script>
</body>
</html>